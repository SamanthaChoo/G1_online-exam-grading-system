{% extends "base.html" %}
{% block content %}
<div class="container py-5">
  <h2>Essay Exams</h2>
  <p class="text-muted">List of exams with essay functionality</p>
  <ul>
    {% for item in exams_meta %}
      {% set exam = item.exam %}
      {% set has_questions = item.has_questions %}
      <li>
        <strong>{{ exam.title }}</strong>
        {%- if not current_user or current_user.role != 'student' -%}
          - <a href="/essay/{{ exam.id }}/questions">Questions</a>
        {%- endif -%}
        {%- if current_user and current_user.role == 'student' and has_questions -%}
          - <a href="/essay/{{ exam.id }}/start">Start Attempt</a>
        {%- endif -%}
        {%- if current_user and current_user.role in ['lecturer','admin'] -%}
          - <a href="/essay/{{ exam.id }}/attempts">Grade Result</a>
        {%- else -%}
          {%- if has_questions -%}
            - <a href="/essay/{{ exam.id }}/attempts">Results</a>
          {%- endif -%}
        {%- endif -%}
      </li>
    {% else %}
      <li>No exams found</li>
    {% endfor %}
  </ul>
</div>
{% endblock %}